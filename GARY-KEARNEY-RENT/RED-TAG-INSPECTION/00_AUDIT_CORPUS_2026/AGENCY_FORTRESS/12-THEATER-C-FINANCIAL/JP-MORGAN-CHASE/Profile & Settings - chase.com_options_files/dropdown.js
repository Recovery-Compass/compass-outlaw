define(["require","blue/$"],(function(e){"use strict";var n=e("blue/$");return function(){return function(e,t,s){var i,o,c,f;function a(e){i.addClass("show"),e&&i.find(".option").first().addClass("has-focus").focus(),f.html(t),n(document).on("click",h)}function u(){i.removeClass("show").find(".has-focus").removeClass("has-focus"),f.html(s),n(document).off("click",h)}function l(){i.hasClass("disabled")||(i.find(".list").is(":visible")?u():a(!0))}function r(e){switch(e.keyCode){case 9:e.shiftKey?document.activeElement===o[0]&&(e.preventDefault(),u(),c.focus()):document.activeElement===o[o.length-1]&&(e.preventDefault(),u(),c.focus());break;case 27:e.preventDefault(),u(),c.focus();break;case 13:u()}}function d(e){if(!i.hasClass("disabled"))switch(e.keyCode){case 13:case 32:e.preventDefault(),a(!0)}}function h(){n.contains(e,arguments[0].target)||u()}return function(){i=n(e),o=i.find(".option"),o.first(),o.last(),c=i.find(".js-trigger"),f=i.find(".accessible-text"),i.on("click",".js-trigger",l).on("keydown",".js-trigger",d).on("click",".option",u).on("keydown",".option",r)}.call(this),{teardown:function(){i&&i.off()}}}}}));